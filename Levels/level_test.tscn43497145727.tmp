[gd_scene load_steps=25 format=3 uid="uid://dxbo6h2bjofxy"]

[ext_resource type="Material" uid="uid://c5onvl33uien7" path="res://Assets/Materiais/M_floor.tres" id="1_7mba1"]
[ext_resource type="PackedScene" uid="uid://c8oxys0qhv8p2" path="res://Player/Player.tscn" id="2_soq8b"]
[ext_resource type="Script" uid="uid://4yh2p0gqosir" path="res://Scripts/GameManager.gd" id="6_ddaal"]
[ext_resource type="PackedScene" uid="uid://c8p28dy6orraf" path="res://Levels/Menus/hud.tscn" id="7_ddaal"]
[ext_resource type="PackedScene" uid="uid://bw3ljwfcfprpl" path="res://Assets/WinterWatcherMap.fbx" id="7_ku5x2"]
[ext_resource type="PackedScene" uid="uid://pjwqtnt478rv" path="res://Levels/Objetos/painel_tv.tscn" id="7_q8e8m"]
[ext_resource type="PackedScene" uid="uid://3744hlicrup2" path="res://Levels/Objetos/MenuFechado.tscn" id="8_ku5x2"]
[ext_resource type="Shader" uid="uid://emm2gmau0t55" path="res://Shaders/postProcessing.gdshader" id="9_ddaal"]
[ext_resource type="PackedScene" uid="uid://cmgd1r4swujfb" path="res://Levels/Salas/RoomPresset.tscn" id="9_gxk0f"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_ddaal"]
sky_horizon_color = Color(0.66224277, 0.6717428, 0.6867428, 1)
ground_horizon_color = Color(0.66224277, 0.6717428, 0.6867428, 1)

[sub_resource type="Sky" id="Sky_gxk0f"]
sky_material = SubResource("ProceduralSkyMaterial_ddaal")

[sub_resource type="Environment" id="Environment_xlufh"]
background_mode = 2
sky = SubResource("Sky_gxk0f")
tonemap_mode = 2
glow_enabled = true
fog_enabled = true
fog_light_color = Color(0.70957583, 0.7324372, 0.79593956, 1)
fog_sun_scatter = 0.5
fog_density = 0.02
fog_sky_affect = 0.7

[sub_resource type="ShaderMaterial" id="ShaderMaterial_xlufh"]
shader = ExtResource("9_ddaal")
shader_parameter/enabled = true
shader_parameter/dithering = true
shader_parameter/colors = 32
shader_parameter/dither_size = 1

[sub_resource type="Gradient" id="Gradient_6ieip"]
offsets = PackedFloat32Array(0, 0.4528302, 1)
colors = PackedColorArray(0.7641296, 0.7909432, 0.82733786, 1, 0.47007626, 0.4700758, 0.47007525, 1, 0.2627451, 0.2627451, 0.2627451, 0)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_w54qd"]
gradient = SubResource("Gradient_6ieip")

[sub_resource type="Curve" id="Curve_p5spi"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.4166667, 0.77528095), 0.0, 0.0, 0, 0, Vector2(0.98484856, 0.29213488), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="CurveTexture" id="CurveTexture_w0slw"]
curve = SubResource("Curve_p5spi")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_nxutr"]
emission_shape = 3
emission_box_extents = Vector3(16, 1, 16)
direction = Vector3(0, -1, 0)
initial_velocity_min = 3.0
initial_velocity_max = 6.0
gravity = Vector3(0, -5, 0)
tangential_accel_min = -8.000002
tangential_accel_max = 7.9999976
damping_max = 4.0
scale_min = 0.5
scale_curve = SubResource("CurveTexture_w0slw")
color_ramp = SubResource("GradientTexture1D_w54qd")

[sub_resource type="Gradient" id="Gradient_465so"]
offsets = PackedFloat32Array(0.3090909, 0.6363636)
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_tchvq"]
gradient = SubResource("Gradient_465so")
width = 65
fill = 1
fill_from = Vector2(0.5, 0.5)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_sdrm6"]
transparency = 1
shading_mode = 0
vertex_color_use_as_albedo = true
albedo_texture = SubResource("GradientTexture2D_tchvq")
billboard_mode = 1

[sub_resource type="QuadMesh" id="QuadMesh_ru4ou"]
material = SubResource("StandardMaterial3D_sdrm6")
size = Vector2(0.3, 0.3)

[sub_resource type="BoxShape3D" id="BoxShape3D_25mqr"]
size = Vector3(50, 1, 50)

[sub_resource type="BoxMesh" id="BoxMesh_stbmk"]
size = Vector3(50, 1, 50)

[node name="Level test" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_xlufh")

[node name="SubViewportContainer" type="SubViewportContainer" parent="."]
physics_interpolation_mode = 0
material = SubResource("ShaderMaterial_xlufh")
offset_right = 960.0
offset_bottom = 540.0

[node name="Snow" type="GPUParticles3D" parent="SubViewportContainer"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.62351227, 19.062958, 2.1440048)
amount = 256
lifetime = 3.5
visibility_aabb = AABB(-43.81296, -47.722363, -39.012207, 89.61482, 49.680996, 73.465546)
process_material = SubResource("ParticleProcessMaterial_nxutr")
draw_pass_1 = SubResource("QuadMesh_ru4ou")

[node name="Chao" type="StaticBody3D" parent="SubViewportContainer"]
collision_layer = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="SubViewportContainer/Chao"]
shape = SubResource("BoxShape3D_25mqr")

[node name="MeshInstance3D" type="MeshInstance3D" parent="SubViewportContainer/Chao"]
material_override = ExtResource("1_7mba1")
mesh = SubResource("BoxMesh_stbmk")

[node name="WinterWatcherMap" parent="SubViewportContainer" instance=ExtResource("7_ku5x2")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.26871395, 0.54112124, -3.9939728)

[node name="Player" parent="." instance=ExtResource("2_soq8b")]
transform = Transform3D(-0.65435827, 0, 0.75618476, 0, 1, 0, -0.75618476, 0, -0.65435827, -9.462622, 2.0298364, -10.071876)

[node name="PainelTV" parent="." node_paths=PackedStringArray("viewports") instance=ExtResource("7_q8e8m")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10.2044115, 0.5306486, -8.768848)
viewports = [NodePath("../CameraRooms/Quarto/CAMERA"), NodePath("../CameraRooms/Sala de Entrega/CAMERA"), NodePath("../CameraRooms/Banheiro/CAMERA"), NodePath("../CameraRooms/Lado de Fora/CAMERA"), NodePath("../CameraRooms/Corredor/CAMERA"), NodePath("../CameraRooms/Escada/CAMERA"), NodePath("../CameraRooms/Almoxarifado/CAMERA")]

[node name="GameManager" type="Node3D" parent="." node_paths=PackedStringArray("cameraRooms", "sessionTimer", "ui_label", "fade_rect", "end_label", "hud_anim") groups=["game_manager"]]
script = ExtResource("6_ddaal")
cameraRooms = NodePath("../CameraRooms")
sessionTimer = NodePath("SessionTimer")
ui_label = NodePath("../HUD/UIRoot/TimerLabel")
fade_rect = NodePath("../HUD/UIRoot/ColorRect")
end_label = NodePath("../HUD/UIRoot/EndLabel")
hud_anim = NodePath("../HUD/UIRoot/EndAnimation")

[node name="AnimationPlayer" type="AnimationPlayer" parent="GameManager"]

[node name="SessionTimer" type="Timer" parent="GameManager"]
wait_time = 360.0
one_shot = true

[node name="HUD" parent="." instance=ExtResource("7_ddaal")]

[node name="Tutorial" parent="." instance=ExtResource("8_ku5x2")]
transform = Transform3D(0.76713157, 0, 0.6414898, 0, 1, 0, -0.6414898, 0, 0.76713157, -10.581309, 1.5062757, -10.096537)

[node name="Marker3D" type="Marker3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.6652117, 0, 3.3273604)

[node name="CameraRooms" type="Node" parent="."]

[node name="Quarto" parent="CameraRooms" instance=ExtResource("9_gxk0f")]

[node name="Camera3D" parent="CameraRooms/Quarto/CAMERA" index="0"]
transform = Transform3D(0.033954725, -0.5342196, 0.8446636, 0.021457823, 0.8453458, 0.5337885, -0.9991931, 0, 0.04016667, 12.402571, 3.8784294, -6.856232)

[node name="GeigerSupport" parent="CameraRooms/Quarto" index="7"]
transform = Transform3D(0.125, 0, 0, 0, -5.4639235e-09, -0.125, 0, 0.125, -5.4639235e-09, 7.60947, 2.2088356, -7.4920983)

[node name="Sala de Entrega" parent="CameraRooms" instance=ExtResource("9_gxk0f")]

[node name="Camera3D" parent="CameraRooms/Sala de Entrega/CAMERA" index="0"]
transform = Transform3D(0.8446461, 0.2236036, -0.48638904, 0.017808028, 0.89634717, 0.44299504, 0.53502876, -0.3828357, 0.75311434, -6.6548986, 5.755131, 12.394001)

[node name="GeigerSupport" parent="CameraRooms/Sala de Entrega" index="7"]
transform = Transform3D(-0.125, -1.0927847e-08, 4.7767137e-16, 0, -5.4639235e-09, -0.125, 1.0927847e-08, -0.125, 5.4639235e-09, -5.0439014, 2.2936437, 12.738917)

[node name="Banheiro" parent="CameraRooms" instance=ExtResource("9_gxk0f")]

[node name="Camera3D" parent="CameraRooms/Banheiro/CAMERA" index="0"]
transform = Transform3D(0.73885536, 0, -0.67386395, 0, 1, 0, 0.67386395, 0, 0.73885536, 2.8943539, 0.8025757, -8.229074)

[node name="GeigerSupport" parent="CameraRooms/Banheiro" index="7"]
transform = Transform3D(-5.4639235e-09, 0.125, -5.4639235e-09, 0, -5.4639235e-09, -0.125, -0.125, -5.4639235e-09, 2.3883568e-16, 2.7560892, 2.5067513, -8.694083)

[node name="Lado de Fora" parent="CameraRooms" instance=ExtResource("9_gxk0f")]

[node name="Camera3D" parent="CameraRooms/Lado de Fora/CAMERA" index="0"]
transform = Transform3D(-0.11023739, 0, 0.99390537, 0, 1, 0, -0.99390537, 0, -0.11023739, 15.198827, 3.8023617, 4.9745593)

[node name="GeigerSupport" parent="CameraRooms/Lado de Fora" index="7"]
transform = Transform3D(-5.4639235e-09, -0.125, 5.4639235e-09, 0, -5.4639235e-09, -0.125, 0.125, -5.4639235e-09, 2.3883568e-16, 1.9461429, 2.580156, 5.5648103)

[node name="Corredor" parent="CameraRooms" instance=ExtResource("9_gxk0f")]

[node name="Camera3D" parent="CameraRooms/Corredor/CAMERA" index="0"]
transform = Transform3D(0.84404814, -0.29908848, 0.44511682, 0.021284537, 0.8480574, 0.5294769, -0.53584504, -0.43742982, 0.72216713, 1.8081291, 3.7254858, 4.096121)

[node name="GeigerSupport" parent="CameraRooms/Corredor" index="7"]
transform = Transform3D(-5.4639235e-09, 0.125, -5.4639235e-09, 0, -5.4639235e-09, -0.125, -0.125, -5.4639235e-09, 2.3883568e-16, -0.6628649, 2.5067518, -0.6989038)

[node name="Escada" parent="CameraRooms" instance=ExtResource("9_gxk0f")]

[node name="Camera3D" parent="CameraRooms/Escada/CAMERA" index="0"]
transform = Transform3D(-0.9991931, 0, 0.040166628, 0, 1, 0, -0.040166628, 0, -0.9991931, 0.73834944, 1.9136982, -12.27939)

[node name="GeigerSupport" parent="CameraRooms/Escada" index="7"]
transform = Transform3D(0.125, 0, 0, 0, -5.4639235e-09, -0.125, 0, 0.125, -5.4639235e-09, 0.4468466, 2.5136714, -12.149843)

[node name="Almoxarifado" parent="CameraRooms" instance=ExtResource("9_gxk0f")]

[node name="Camera3D" parent="CameraRooms/Almoxarifado/CAMERA" index="0"]
transform = Transform3D(0.9991931, 0, -0.04016671, 0.02172327, 0.8411334, 0.5403912, 0.033785563, -0.5408277, 0.8404546, -8.680545, 3.4765792, 4.02032)

[node name="GeigerSupport" parent="CameraRooms/Almoxarifado" index="7"]
transform = Transform3D(0.125, 0, 0, 0, -5.4639235e-09, -0.125, 0, 0.125, -5.4639235e-09, -7.0862045, 2.2088356, -3.636404)

[connection signal="timeout" from="GameManager/SessionTimer" to="GameManager" method="_on_session_timer_timeout"]

[editable path="HUD"]
[editable path="CameraRooms/Quarto"]
[editable path="CameraRooms/Quarto/CAMERA"]
[editable path="CameraRooms/Sala de Entrega"]
[editable path="CameraRooms/Sala de Entrega/CAMERA"]
[editable path="CameraRooms/Banheiro"]
[editable path="CameraRooms/Banheiro/CAMERA"]
[editable path="CameraRooms/Lado de Fora"]
[editable path="CameraRooms/Lado de Fora/CAMERA"]
[editable path="CameraRooms/Corredor"]
[editable path="CameraRooms/Corredor/CAMERA"]
[editable path="CameraRooms/Escada"]
[editable path="CameraRooms/Escada/CAMERA"]
[editable path="CameraRooms/Almoxarifado"]
[editable path="CameraRooms/Almoxarifado/CAMERA"]
